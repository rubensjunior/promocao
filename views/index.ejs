<!-- Wappler include head-page="layouts/main" fontawesome_5="cdn" bootstrap5="local" is="dmx-app" id="index" appConnect="local" components="{dmxValidator:{}}" -->
<section class="container-fluid bg-light" id="hero_section">
    <!-- Formas geométricas animadas -->
    <div class="floating-shapes">
    </div>

    <div class="container">
        <div class="row align-items-center">
            <div class="col">
                <h1 class="titulo-hero mb-4">Promoção Premiada Rodrigues Colchões</h1>
                <h3 class="subtitulo-hero">Raspou, Ganhou, Cadastrou: você pode levar R$ 10.000 em compras!</h3>
                <p>A cada R$ 500 em compras nas lojas Rodrigues Colchões, você ganha uma raspadinha exclusiva. Ganhe prêmios instantâneos na hora e ainda concorra a R$ 10.000 em compras!</p>
            </div>
            <div class="col">
                <!-- Formulário Multistep -->
                <div class="card shadow-lg text-start">
                    <div class="card-body">
                        <!-- Progress Bar -->
                        <div class="progress-container mb-4">
                            <div class="progress-steps">
                                <div class="progress-step active" id="progress-step-1">
                                    <div class="step-circle">1</div>
                                    <div class="step-label">Dados Pessoais</div>
                                </div>
                                <div class="progress-step" id="progress-step-2">
                                    <div class="step-circle">2</div>
                                    <div class="step-label">Endereço</div>
                                </div>
                                <div class="progress-step" id="progress-step-3">
                                    <div class="step-circle">3</div>
                                    <div class="step-label">Autenticação</div>
                                </div>
                            </div>
                        </div>

                        <!-- Formulário Server Connect -->
                        <form is="dmx-serverconnect-form" id="registration_form" class="needs-validation" method="post" action="/api/register">

                            <!-- Etapa 1: Dados do Usuário -->
                            <div class="step-content" id="step1">

                                <div class="form-group mb-3">
                                    <label for="nome_completo" class="form-label">Nome Completo</label>
                                    <input type="text" class="form-control" id="nome_completo" name="nome_completo" required data-msg-required="Por favor, digite seu nome completo" data-rule-lettersonly="true" data-msg-lettersonly="Apenas letras são permitidas">
                                </div>

                                <div class="form-group mb-3">
                                    <label for="cpf" class="form-label">CPF</label>
                                    <input type="text" class="form-control" id="cpf" name="cpf" required data-msg-required="Por favor, digite seu CPF" data-rule-pattern="^\d{3}\.\d{3}\.\d{3}-\d{2}$" data-msg-pattern="Digite um CPF válido (000.000.000-00)" placeholder="000.000.000-00">
                                </div>

                                <div class="form-group mb-3">
                                    <label for="whatsapp" class="form-label">WhatsApp</label>
                                    <input type="tel" class="form-control" id="whatsapp" name="whatsapp" required data-msg-required="Por favor, digite seu WhatsApp" data-rule-pattern="^\(\d{2}\) \d{4,5}-\d{4}$" data-msg-pattern="Digite um WhatsApp válido (00) 00000-0000" placeholder="(00) 00000-0000">
                                </div>

                                <div class="d-grid">
                                    <button type="button" class="btn btn-primary" onclick="nextStep(1)">
                                        Próxima Etapa <i class="fas fa-arrow-right"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- Etapa 2: Endereço -->
                            <div class="step-content d-none" id="step2">

                                <div class="form-group mb-3">
                                    <label for="rua" class="form-label">Nome da Rua</label>
                                    <input type="text" class="form-control" id="rua" name="rua" required data-msg-required="Por favor, digite o nome da rua">
                                </div>

                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <div class="form-group mb-3">
                                            <label for="numero" class="form-label">Número</label>
                                            <input type="text" class="form-control" id="numero" name="numero" required data-msg-required="Por favor, digite o número">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group mb-3">
                                            <label for="cep" class="form-label">CEP</label>
                                            <input type="text" class="form-control" id="cep" name="cep" required data-msg-required="Por favor, digite o CEP" data-rule-pattern="^\d{5}-\d{3}$" data-msg-pattern="Digite um CEP válido (00000-000)" placeholder="00000-000">
                                        </div>
                                    </div>
                                </div>

                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <div class="form-group mb-3">
                                            <label for="cidade" class="form-label">Cidade</label>
                                            <input type="text" class="form-control" id="cidade" name="cidade" required data-msg-required="Por favor, digite a cidade">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group mb-3">
                                            <label for="estado" class="form-label">Estado</label>
                                            <select id="estado" name="estado" class="form-select" required data-msg-required="Por favor, selecione o estado">
                                                <option value="" selected disabled>Selecione o estado</option>
                                                <option value="AC">Acre</option>
                                                <option value="AL">Alagoas</option>
                                                <option value="AP">Amapá</option>
                                                <option value="AM">Amazonas</option>
                                                <option value="BA">Bahia</option>
                                                <option value="CE">Ceará</option>
                                                <option value="DF">Distrito Federal</option>
                                                <option value="ES">Espírito Santo</option>
                                                <option value="GO">Goiás</option>
                                                <option value="MA">Maranhão</option>
                                                <option value="MT">Mato Grosso</option>
                                                <option value="MS">Mato Grosso do Sul</option>
                                                <option value="MG">Minas Gerais</option>
                                                <option value="PA">Pará</option>
                                                <option value="PB">Paraíba</option>
                                                <option value="PR">Paraná</option>
                                                <option value="PE">Pernambuco</option>
                                                <option value="PI">Piauí</option>
                                                <option value="RJ">Rio de Janeiro</option>
                                                <option value="RN">Rio Grande do Norte</option>
                                                <option value="RS">Rio Grande do Sul</option>
                                                <option value="RO">Rondônia</option>
                                                <option value="RR">Roraima</option>
                                                <option value="SC">Santa Catarina</option>
                                                <option value="SP">São Paulo</option>
                                                <option value="SE">Sergipe</option>
                                                <option value="TO">Tocantins</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="d-grid gap-2 d-md-flex justify-content-md-between">
                                    <button type="button" class="btn btn-outline-secondary" onclick="previousStep(2)">
                                        <i class="fas fa-arrow-left"></i> Etapa Anterior
                                    </button>
                                    <button type="button" class="btn btn-primary" onclick="nextStep(2)">
                                        Próxima Etapa <i class="fas fa-arrow-right"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- Etapa 3: Autenticação -->
                            <div class="step-content d-none" id="step3">

                                <div class="form-group mb-3">
                                    <label for="email" class="form-label">Email</label>
                                    <input type="email" class="form-control" id="email" name="email" required data-msg-required="Por favor, digite seu email" data-rule-email="true" data-msg-email="Por favor, digite um email válido">
                                </div>

                                <div class="form-group mb-3">
                                    <label for="senha" class="form-label">Senha</label>
                                    <input type="password" class="form-control" id="senha" name="senha" required data-msg-required="Por favor, digite sua senha" minlength="8" data-msg-minlength="A senha deve ter pelo menos 8 caracteres">
                                </div>

                                <div class="form-group mb-3">
                                    <label for="confirmar_senha" class="form-label">Confirmar Senha</label>
                                    <input type="password" class="form-control" id="confirmar_senha" name="confirmar_senha" required data-msg-required="Por favor, confirme sua senha" data-rule-equalto="#senha" data-msg-equalto="As senhas não coincidem">
                                </div>

                                <div class="form-group mb-3">
                                    <div class="form-check">
                                        <input type="checkbox" class="form-check-input" id="aceita_contato" name="aceita_contato" value="1" required data-msg-required="Você deve aceitar os termos para continuar">
                                        <label class="form-check-label" for="aceita_contato">
                                            Aceito ser contatado pela Rodrigues Colchões conforme as diretrizes da LGPD
                                        </label>
                                    </div>
                                </div>

                                <div class="d-grid gap-2 d-md-flex justify-content-md-between">
                                    <button type="button" class="btn btn-outline-secondary" onclick="previousStep(3)">
                                        <i class="fas fa-arrow-left"></i> Etapa Anterior
                                    </button>
                                    <button type="submit" class="btn btn-success">
                                        <i class="fas fa-check"></i> Finalizar Cadastro
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<meta name="ac:route" content="/">

<!-- JavaScript para controle das etapas -->
<script>
    let currentStep = 1;

function nextStep(step) {
    // Validar campos da etapa atual antes de avançar
    const currentStepElement = document.getElementById(`step${step}`);
    const inputs = currentStepElement.querySelectorAll('input[required], select[required]');
    let isValid = true;

    inputs.forEach(input => {
        if (!input.value.trim()) {
            isValid = false;
            input.classList.add('is-invalid');
        } else {
            input.classList.remove('is-invalid');
        }
    });

    if (isValid) {
        document.getElementById(`step${step}`).classList.add('d-none');
        document.getElementById(`step${step + 1}`).classList.remove('d-none');
        currentStep = step + 1;
        updateProgressBar();
    }
}

function previousStep(step) {
    document.getElementById(`step${step}`).classList.add('d-none');
    document.getElementById(`step${step - 1}`).classList.remove('d-none');
    currentStep = step - 1;
    updateProgressBar();
}

function updateProgressBar() {
    const progressText = document.getElementById('progress-text');
    progressText.textContent = `Etapa ${currentStep} de 3`;
    
    // Remover classe active de todos os steps
    document.querySelectorAll('.progress-step').forEach(step => {
        step.classList.remove('active', 'completed');
    });
    
    // Adicionar classe completed aos steps anteriores
    for (let i = 1; i < currentStep; i++) {
        document.getElementById(`progress-step-${i}`).classList.add('completed');
    }
    
    // Adicionar classe active ao step atual
    document.getElementById(`progress-step-${currentStep}`).classList.add('active');
}
</script>